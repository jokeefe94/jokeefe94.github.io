<!-- API Key for GMaps: AIzaSyAv9gp29mOcmoBWU4I_7NPVfk-msiFaMm0 -->

<!DOCTYPE html>
<html>
  <head>
    <style type="text/css">
      html, body, #map-canvas { height: 100%; margin: 0; padding: 0;}
    </style>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAv9gp29mOcmoBWU4I_7NPVfk-msiFaMm0">
    </script>
    <script type="text/javascript">
      function initialize() 
      {
        var mapOptions = {
          center: { lat: 51.507227, lng: -0.127211},
          zoom: 12
        };
        var map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);


      if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
      }
      else
      {// code for IE6, IE5
       xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
      xmlhttp.open("GET","http://www.tfl.gov.uk/tfl/syndication/feeds/cycle-hire/livecyclehireupdates.xml",false);
      xmlhttp.send();
      xmlDoc=xmlhttp.responseXML; 

      var x=xmlDoc.getElementsByTagName("station");

      var markers = new Array();
      for (i=0;i<x.length;i++)
      { 
         var myLatlng = new google.maps.LatLng(x[i].getElementsByTagName("lat")[0].childNodes[0].nodeValue,x[i].getElementsByTagName("long")[0].childNodes[0].nodeValue);

         var myTitle = x[i].getElementsByTagName("name")[0].childNodes[0].nodeValue

        // To add the marker to the map, use the 'map' property
          markers[i] = new google.maps.Marker({
          position: myLatlng,
          map: map,
          title: myTitle
        }); 
      }
    }

    google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
<div id="map-canvas"></div>
  </body>
</html>